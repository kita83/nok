# 概要
このドキュメントでは、プルリクエスト（以下PR）の説明文書作成に関するベストプラクティスを説明します。本プロジェクトでは、一貫性のあるPR説明の作成を通じて、レビュープロセスの効率化と品質向上を目指しています。

## プルリクエストの目的

PRは以下の目的を達成するための重要なプロセスです：

1. **コード品質の向上**: レビューを通じてバグや設計上の問題を早期に発見
2. **知識の共有**: チーム内での実装アプローチやドメイン知識の共有
3. **開発履歴の整理**: 機能単位での変更履歴の管理
4. **CI/CDパイプラインの起動**: 自動テストやデプロイの実行

## PR説明の自動生成フロー

当プロジェクトではPR説明を効率的に作成するため、GitHub CLIとAIを組み合わせたツールを提供しています。以下の手順で使用できます：

1. PR作成後、以下のコマンドで関連情報を収集（IssueIDとPR IDは作業担当者に確認してください）：

   ```bash
   # Issueの内容取得
   gh issue view $issueId --repo organization/huga-monorepo
   
   # PRのdiff取得
   gh pr diff $prId 
   
   # 既存のPR説明があれば取得（再更新やスクリーンショットなどの情報活用のため）
   gh pr view $prId --json body
   ```

2. 収集した情報とPRの内容をもとに、PR説明を生成する。

生成形式は、Markdown形式で記述する。
詳しい書き方は、PR説明の構造や良いPR説明の例を参考

3. 生成された内容を見直した後、生成内容をMarkdownファイルに出力する。

markdownファイルに一度出力したものを利用して、GitHubのDescriptionを更新した方が動作が安定するために行う。

4. 生成されたマークダウンファイルを下に、GitHubのDescriptionを更新

何度か失敗した場合は諦めて、手動で更新してもらうように促す。


## PR説明の構造

PR説明は以下の構造に従って作成します：

```markdown
## 🎫 Issues

- #12345  # 関連するIssue番号

## 👌 Summary

簡潔で明確な変更内容の要約。何を実装したのか、なぜその変更が必要だったのかを説明。

## 📚 References/Docs

関連するドキュメントや参考リソースへのリンク。設計資料、APIドキュメント、使用したライブラリのドキュメントなど。

## 🔍 Details

変更の詳細な説明。以下のような情報を含む：
- 実装したアプローチとその選択理由
- 主要なファイル変更の説明
- 技術的な決定事項と背景
- 既存コードへの影響

## 👀 Review Points

レビュアーに特に注目してほしいポイント：
- 複雑なロジックや判断に迷った部分
- パフォーマンスや安全性に関する懸念
- 代替案の検討内容

## 📸 Screenshots

Before | After
---- | ----
<img src="" width="320"/> | <img src="" width="320"/>

## 🧪 TestCases

- [ ] テストケース1
- [ ] テストケース2
- [ ] テストケース3
```

## 効果的なPR説明のポイント

1. **具体的かつ簡潔に**
   - 変更内容を具体的に、かつ簡潔に説明する
   - 技術用語を適切に使用し、冗長な表現を避ける

2. **コンテキストを提供する**
   - なぜその変更が必要だったのか、背景情報を提供する
   - 関連するIssueやドキュメントへのリンクを含める

3. **視覚的な情報を活用する**
   - UI変更の場合はBefore/Afterのスクリーンショットを添付
   - 複雑なフローの場合は図やダイアグラムを使用

4. **レビューのしやすさを考慮する**
   - 大規模な変更は論理的なセクションに分割して説明
   - 特に注目すべき箇所や懸念点を明示

## 良いPR説明の例

```markdown
## 🎫 Issues

- #789 ユーザー認証システムのセキュリティ強化

## 👌 Summary

ユーザー認証にResult型を導入し、エラーハンドリングを型安全かつ明示的に行えるようにしました。これにより認証失敗時の処理が統一され、セキュリティが向上します。

## 📚 References/Docs

- [Result型パターンの解説](https://example.com/result-pattern)
- [セキュリティベストプラクティス](https://example.com/security-best-practices)

## 🔍 Details

- `UserAuthService`に以下の変更を実装:
  - 認証結果を`Result<User, AuthError>`型で返却
  - エラーの種類を`AuthError`型で明示的に区別（不正な認証情報、アカウントロック、期限切れなど）
  - 各エラーケースに対応するエラーメッセージとロギングを実装

- 周辺コンポーネントの対応:
  - 認証結果を処理する全コンポーネントでResult型のハンドリングを実装
  - エラーケースに応じたユーザーフレンドリーなUI表示を追加

## 👀 Review Points

- Result型の使用パターンは一貫していますか？
- エラーメッセージはユーザーにとって分かりやすいでしょうか？
- 追加したロギングは運用上十分な情報を提供していますか？

## 📸 Screenshots

Before | After
---- | ----
<img src="" width="320"/> | <img src="" width="320"/>

## 🧪 TestCases

- [ ] 正常なログインフロー
- [ ] 不正な認証情報によるログイン失敗
- [ ] アカウントロック状態でのログイン試行
- [ ] 認証トークン期限切れ処理

```